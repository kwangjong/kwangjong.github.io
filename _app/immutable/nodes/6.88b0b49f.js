import{R as ue}from"../chunks/control.f5b05b5f.js";import{S as me,i as pe,s as fe,k as o,a as y,y as he,q as N,R as ve,l as i,m as d,h as t,c as S,z as _e,r as C,n as c,N as Z,E as s,b as R,A as ke,F as ee,L as we,g as ge,d as ye,B as Se,O as Ee,o as be,T as Te}from"../chunks/index.158cc983.js";import{S as xe,r as $e}from"../chunks/SyntaxHighlight.3a61cfb0.js";function oe(p,a){return new ue(p,a)}new TextEncoder;async function je(){let p=localStorage.getItem("token");if(p!=null)await fetch("https://107106.xyz/auth",{method:"DELETE",headers:{Token:p}}).then(a=>a.status!=401).then(a=>{if(!a)throw oe(307,"/admin")});else throw oe(307,"/admin")}async function Ie(){return console.log("Loading"),await je()}const Re=Object.freeze(Object.defineProperty({__proto__:null,load:Ie},Symbol.toStringTag,{value:"Module"}));const{document:q}=Te;function Oe(p){let a,k,H,r,T,v,P,x,l,f,n,E,_,u,h,b,A,F,$,K,M,w,L,X,j,Y,g,I,G,J,O,Q,U,W,te;return l=new xe({}),{c(){a=o("link"),k=o("script"),r=o("script"),v=o("script"),x=y(),he(l.$$.fragment),f=y(),n=o("h1"),E=N("editor"),_=y(),u=o("div"),h=o("div"),b=o("button"),A=N("edit"),F=y(),$=o("button"),K=N("preview"),M=y(),w=o("div"),L=o("div"),X=y(),j=o("textarea"),Y=y(),g=o("div"),I=o("button"),G=N("cancel"),J=y(),O=o("button"),Q=N("save"),this.h()},l(e){const m=ve("svelte-10tpdyr",q.head);a=i(m,"LINK",{rel:!0,href:!0,integrity:!0,crossorigin:!0}),k=i(m,"SCRIPT",{src:!0});var ie=d(k);ie.forEach(t),r=i(m,"SCRIPT",{src:!0});var ce=d(r);ce.forEach(t),v=i(m,"SCRIPT",{src:!0});var de=d(v);de.forEach(t),m.forEach(t),x=S(e),_e(l.$$.fragment,e),f=S(e),n=i(e,"H1",{class:!0});var se=d(n);E=C(se,"editor"),se.forEach(t),_=S(e),u=i(e,"DIV",{class:!0});var D=d(u);h=i(D,"DIV",{class:!0});var V=d(h);b=i(V,"BUTTON",{});var re=d(b);A=C(re,"edit"),re.forEach(t),F=S(V),$=i(V,"BUTTON",{});var ae=d($);K=C(ae,"preview"),ae.forEach(t),V.forEach(t),M=S(D),w=i(D,"DIV",{class:!0});var B=d(w);L=i(B,"DIV",{class:!0}),d(L).forEach(t),X=S(B),j=i(B,"TEXTAREA",{class:!0}),d(j).forEach(t),B.forEach(t),Y=S(D),g=i(D,"DIV",{class:!0});var z=d(g);I=i(z,"BUTTON",{onclick:!0});var ne=d(I);G=C(ne,"cancel"),ne.forEach(t),J=S(z),O=i(z,"BUTTON",{});var le=d(O);Q=C(le,"save"),le.forEach(t),z.forEach(t),D.forEach(t),this.h()},h(){c(a,"rel","stylesheet"),c(a,"href","https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css"),c(a,"integrity","sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X"),c(a,"crossorigin","anonymous"),Z(k.src,H="//cdn.jsdelivr.net/npm/marked/marked.min.js")||c(k,"src",H),Z(r.src,T="//cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js")||c(r,"src",T),Z(v.src,P="https://cdn.jsdelivr.net/npm/marked-katex-extension/lib/index.umd.js")||c(v,"src",P),c(n,"class","svelte-wwn397"),c(h,"class","markdown-header"),c(L,"class","preview"),j.value=p[0],c(j,"class","svelte-wwn397"),c(w,"class","markdown-body svelte-wwn397"),c(I,"onclick","location.href='/'"),c(g,"class","markdown-footer"),c(u,"class","markdown-editor svelte-wwn397")},m(e,m){s(q.head,a),s(q.head,k),s(q.head,r),s(q.head,v),R(e,x,m),ke(l,e,m),R(e,f,m),R(e,n,m),s(n,E),R(e,_,m),R(e,u,m),s(u,h),s(h,b),s(b,A),s(h,F),s(h,$),s($,K),s(u,M),s(u,w),s(w,L),s(w,X),s(w,j),s(u,Y),s(u,g),s(g,I),s(I,G),s(g,J),s(g,O),s(O,Q),U=!0,W||(te=[ee(b,"click",p[2]),ee($,"click",p[1]),ee(O,"click",p[3])],W=!0)},p:we,i(e){U||(ge(l.$$.fragment,e),U=!0)},o(e){ye(l.$$.fragment,e),U=!1},d(e){t(a),t(k),t(r),t(v),e&&t(x),Se(l,e),e&&t(f),e&&t(n),e&&t(_),e&&t(u),W=!1,Ee(te)}}}function De(p){let a=new Date(Date.now()),H=`---
title: 
tags: [ ]
date: ${`${a.toISOString().split("T")[0]} ${a.toString().split(" ")[4]} -${a.toString().split("-")[1].slice(0,2)}:${a.toString().split("-")[1].slice(2,5)}`}
---
`,r,T;function v(){const l=/^---[\s\S]*?---\s*/m,f=r.value.replace(l,""),n={throwOnError:!1},E={mangle:!1,headerIds:!1};marked.use(markedKatex(n),E);let _=marked.parse(f);console.log(_),r.style.display="none",T.innerHTML=_,$e()}function P(){r.style.display="block",T.innerHTML=""}function x(){try{let l=r.value,f=l.split("---")[1],n=jsyaml.load(f);n.markdown=l;const E=/^---[\s\S]*?---\s*/m,_=r.value.replace(E,""),u={throwOnError:!1};marked.use(markedKatex(u)),n.html=marked.parse(_),n.url=`${n.date.toISOString().split("T")[0]}-${n.title.replaceAll(" ","-")}`;let h=localStorage.getItem("token");const b=fetch("http://104.154.96.6:8080/blog/",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Token:h??""}})}catch(l){window.alert(l.message)}}return be(()=>{r=document.querySelector("textarea"),T=document.querySelector(".preview"),r.addEventListener("keydown",l=>{if(l.key==="Tab"){const f=r.selectionStart,n=r.selectionEnd;r.value=r.value.substring(0,f)+"	"+r.value.substring(n),r.selectionStart=r.selectionEnd=f+1,l.preventDefault()}})}),[H,v,P,x]}class qe extends me{constructor(a){super(),pe(this,a,De,Oe,fe,{})}}export{qe as component,Re as universal};
