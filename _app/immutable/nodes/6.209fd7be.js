import{a as ut,S as pt,r as mt,g as ft}from"../chunks/SyntaxHighlight.3ea466e0.js";import{S as vt,i as _t,s as ht,k as i,a as x,y as gt,q as C,R as wt,l as c,m as u,h as e,c as j,z as kt,r as L,n as p,N as tt,E as s,b as q,A as yt,F as G,L as Tt,g as bt,d as St,B as Et,O as xt,o as jt,T as $t}from"../chunks/index.158cc983.js";import{g as ot}from"../chunks/navigation.f206f22e.js";async function It({fetch:h,url:d}){await ut();const m=d.searchParams.get("edit");return m!=null?{content:await h(`https://107106.xyz/blog/${m}`).then(o=>o.json())}:{content:null}}const Ht=Object.freeze(Object.defineProperty({__proto__:null,load:It},Symbol.toStringTag,{value:"Module"}));const{document:V}=$t;function Ot(h){let d,m,_,o,K,g,a,y,w,$,k,U,l,n,r,f,T,H,b,I,z,S,P,X,O,Y,E,D,J,Q,M,W,B,Z,et;return w=new pt({}),{c(){d=i("link"),m=i("script"),o=i("script"),g=i("script"),y=x(),gt(w.$$.fragment),$=x(),k=i("h1"),U=C("editor"),l=x(),n=i("div"),r=i("div"),f=i("button"),T=C("edit"),H=x(),b=i("button"),I=C("preview"),z=x(),S=i("div"),P=i("div"),X=x(),O=i("textarea"),Y=x(),E=i("div"),D=i("button"),J=C("cancel"),Q=x(),M=i("button"),W=C("save"),this.h()},l(t){const v=wt("svelte-10tpdyr",V.head);d=c(v,"LINK",{rel:!0,href:!0,integrity:!0,crossorigin:!0}),m=c(v,"SCRIPT",{src:!0});var it=u(m);it.forEach(e),o=c(v,"SCRIPT",{src:!0});var ct=u(o);ct.forEach(e),g=c(v,"SCRIPT",{src:!0});var dt=u(g);dt.forEach(e),v.forEach(e),y=j(t),kt(w.$$.fragment,t),$=j(t),k=c(t,"H1",{class:!0});var st=u(k);U=L(st,"editor"),st.forEach(e),l=j(t),n=c(t,"DIV",{class:!0});var N=u(n);r=c(N,"DIV",{class:!0});var R=u(r);f=c(R,"BUTTON",{});var at=u(f);T=L(at,"edit"),at.forEach(e),H=j(R),b=c(R,"BUTTON",{});var nt=u(b);I=L(nt,"preview"),nt.forEach(e),R.forEach(e),z=j(N),S=c(N,"DIV",{class:!0});var A=u(S);P=c(A,"DIV",{class:!0}),u(P).forEach(e),X=j(A),O=c(A,"TEXTAREA",{class:!0}),u(O).forEach(e),A.forEach(e),Y=j(N),E=c(N,"DIV",{class:!0});var F=u(E);D=c(F,"BUTTON",{});var rt=u(D);J=L(rt,"cancel"),rt.forEach(e),Q=j(F),M=c(F,"BUTTON",{});var lt=u(M);W=L(lt,"save"),lt.forEach(e),F.forEach(e),N.forEach(e),this.h()},h(){p(d,"rel","stylesheet"),p(d,"href","https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css"),p(d,"integrity","sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X"),p(d,"crossorigin","anonymous"),tt(m.src,_="//cdn.jsdelivr.net/npm/marked/marked.min.js")||p(m,"src",_),tt(o.src,K="//cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js")||p(o,"src",K),tt(g.src,a="https://cdn.jsdelivr.net/npm/marked-katex-extension/lib/index.umd.js")||p(g,"src",a),p(k,"class","svelte-wwn397"),p(r,"class","markdown-header"),p(P,"class","preview"),O.value=h[0],p(O,"class","svelte-wwn397"),p(S,"class","markdown-body svelte-wwn397"),p(E,"class","markdown-footer"),p(n,"class","markdown-editor svelte-wwn397")},m(t,v){s(V.head,d),s(V.head,m),s(V.head,o),s(V.head,g),q(t,y,v),yt(w,t,v),q(t,$,v),q(t,k,v),s(k,U),q(t,l,v),q(t,n,v),s(n,r),s(r,f),s(f,T),s(r,H),s(r,b),s(b,I),s(n,z),s(n,S),s(S,P),s(S,X),s(S,O),s(n,Y),s(n,E),s(E,D),s(D,J),s(E,Q),s(E,M),s(M,W),B=!0,Z||(et=[G(f,"click",h[2]),G(b,"click",h[1]),G(D,"click",h[3]),G(M,"click",h[4])],Z=!0)},p:Tt,i(t){B||(bt(w.$$.fragment,t),B=!0)},o(t){St(w.$$.fragment,t),B=!1},d(t){e(d),e(m),e(o),e(g),t&&e(y),Et(w,t),t&&e($),t&&e(k),t&&e(l),t&&e(n),Z=!1,xt(et)}}}function Dt(h,d,m){let{data:_}=d,o=new Date(Date.now());console.log(o.toString().split("GMT")[1].slice(3,5));let g=`---
title: 
tags: [ ]
date: ${`${o.toISOString().split("T")[0]} ${o.toString().split(" ")[4]} ${o.toString().split("GMT")[1].slice(0,3)}:${o.toString().split("GMT")[1].slice(3,5)}`}
---
`,a,y;function w(){const l=/^---[\s\S]*?---\s*/m,n=a.value.replace(l,""),r={throwOnError:!1},f={mangle:!1,headerIds:!1};marked.use(markedKatex(r),f);let T=marked.parse(n);console.log(T),a.style.display="none",y.innerHTML=T,mt()}function $(){a.style.display="block",y.innerHTML=""}function k(){ot("/blog")}function U(){try{let l=a.value,n=l.split("---")[1],r=jsyaml.load(n),f={Id:_.content==null?null:_.content.Id,Title:r.title,Date:r.date,MarkDown:l,Tags:r.tags,Html:"",Url:""};const T=/^---[\s\S]*?---\s*/m,H=a.value.replace(T,""),b={throwOnError:!1};marked.use(markedKatex(b)),f.Html=marked.parse(H),f.Url=`${r.date.toISOString().split("T")[0]}-${r.title.replaceAll(" ","-")}`;let I=ft();const z=fetch("https://107106.xyz/blog/",{method:_.content==null?"POST":"PUT",body:JSON.stringify(f),headers:{"Content-Type":"application/json",Token:I??""}}).then(()=>{ot("/blog")})}catch(l){window.alert(l.message)}}return jt(()=>{a=document.querySelector("textarea"),y=document.querySelector(".preview"),a.addEventListener("keydown",l=>{if(l.key==="Tab"){const n=a.selectionStart,r=a.selectionEnd;a.value=a.value.substring(0,n)+"	"+a.value.substring(r),a.selectionStart=a.selectionEnd=n+1,l.preventDefault()}}),_.content!=null&&(a.value=_.content.MarkDown)}),h.$$set=l=>{"data"in l&&m(5,_=l.data)},[g,w,$,k,U,_]}class Pt extends vt{constructor(d){super(),_t(this,d,Dt,Ot,ht,{data:5})}}export{Pt as component,Ht as universal};
