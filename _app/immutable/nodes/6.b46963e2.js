import{a as ut,S as pt,r as mt,g as ft}from"../chunks/SyntaxHighlight.d3cf2476.js";import{S as vt,i as _t,s as ht,k as o,a as x,y as gt,q as L,R as wt,l as i,m as u,h as e,c as j,z as kt,r as q,n as p,N as tt,E as s,b as M,A as yt,F as K,L as bt,g as Tt,d as St,B as Et,O as xt,o as jt,T as $t}from"../chunks/index.158cc983.js";import{g as ot}from"../chunks/navigation.40117d54.js";async function It({fetch:h,url:c}){await ut();const m=c.searchParams.get("edit");return m!=null?{content:await h(`https://107106.xyz/blog/${m}`).then(d=>d.json())}:{content:null}}const Pt=Object.freeze(Object.defineProperty({__proto__:null,load:It},Symbol.toStringTag,{value:"Module"}));const{document:V}=$t;function Ot(h){let c,m,_,d,X,g,a,y,w,$,k,H,l,n,r,f,b,P,T,I,z,S,C,Y,O,G,E,D,J,Q,N,W,B,Z,et;return w=new pt({}),{c(){c=o("link"),m=o("script"),d=o("script"),g=o("script"),y=x(),gt(w.$$.fragment),$=x(),k=o("h1"),H=L("editor"),l=x(),n=o("div"),r=o("div"),f=o("button"),b=L("edit"),P=x(),T=o("button"),I=L("preview"),z=x(),S=o("div"),C=o("div"),Y=x(),O=o("textarea"),G=x(),E=o("div"),D=o("button"),J=L("cancel"),Q=x(),N=o("button"),W=L("save"),this.h()},l(t){const v=wt("svelte-10tpdyr",V.head);c=i(v,"LINK",{rel:!0,href:!0,integrity:!0,crossorigin:!0}),m=i(v,"SCRIPT",{src:!0});var it=u(m);it.forEach(e),d=i(v,"SCRIPT",{src:!0});var ct=u(d);ct.forEach(e),g=i(v,"SCRIPT",{src:!0});var dt=u(g);dt.forEach(e),v.forEach(e),y=j(t),kt(w.$$.fragment,t),$=j(t),k=i(t,"H1",{class:!0});var st=u(k);H=q(st,"editor"),st.forEach(e),l=j(t),n=i(t,"DIV",{class:!0});var U=u(n);r=i(U,"DIV",{class:!0});var R=u(r);f=i(R,"BUTTON",{});var at=u(f);b=q(at,"edit"),at.forEach(e),P=j(R),T=i(R,"BUTTON",{});var nt=u(T);I=q(nt,"preview"),nt.forEach(e),R.forEach(e),z=j(U),S=i(U,"DIV",{class:!0});var A=u(S);C=i(A,"DIV",{class:!0}),u(C).forEach(e),Y=j(A),O=i(A,"TEXTAREA",{class:!0}),u(O).forEach(e),A.forEach(e),G=j(U),E=i(U,"DIV",{class:!0});var F=u(E);D=i(F,"BUTTON",{});var rt=u(D);J=q(rt,"cancel"),rt.forEach(e),Q=j(F),N=i(F,"BUTTON",{});var lt=u(N);W=q(lt,"save"),lt.forEach(e),F.forEach(e),U.forEach(e),this.h()},h(){p(c,"rel","stylesheet"),p(c,"href","https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css"),p(c,"integrity","sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X"),p(c,"crossorigin","anonymous"),tt(m.src,_="//cdn.jsdelivr.net/npm/marked/marked.min.js")||p(m,"src",_),tt(d.src,X="//cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js")||p(d,"src",X),tt(g.src,a="https://cdn.jsdelivr.net/npm/marked-katex-extension/lib/index.umd.js")||p(g,"src",a),p(k,"class","svelte-wwn397"),p(r,"class","markdown-header"),p(C,"class","preview"),O.value=h[0],p(O,"class","svelte-wwn397"),p(S,"class","markdown-body svelte-wwn397"),p(E,"class","markdown-footer"),p(n,"class","markdown-editor svelte-wwn397")},m(t,v){s(V.head,c),s(V.head,m),s(V.head,d),s(V.head,g),M(t,y,v),yt(w,t,v),M(t,$,v),M(t,k,v),s(k,H),M(t,l,v),M(t,n,v),s(n,r),s(r,f),s(f,b),s(r,P),s(r,T),s(T,I),s(n,z),s(n,S),s(S,C),s(S,Y),s(S,O),s(n,G),s(n,E),s(E,D),s(D,J),s(E,Q),s(E,N),s(N,W),B=!0,Z||(et=[K(f,"click",h[2]),K(T,"click",h[1]),K(D,"click",h[3]),K(N,"click",h[4])],Z=!0)},p:bt,i(t){B||(Tt(w.$$.fragment,t),B=!0)},o(t){St(w.$$.fragment,t),B=!1},d(t){e(c),e(m),e(d),e(g),t&&e(y),Et(w,t),t&&e($),t&&e(k),t&&e(l),t&&e(n),Z=!1,xt(et)}}}function Dt(h,c,m){let{data:_}=c,d=new Date(Date.now()),g=`---
title: 
tags: [ ]
date: ${`${d.toISOString().split("T")[0]} ${d.toString().split(" ")[4]} -${d.toString().split("-")[1].slice(0,2)}:${d.toString().split("-")[1].slice(2,5)}`}
---
`,a,y;function w(){const l=/^---[\s\S]*?---\s*/m,n=a.value.replace(l,""),r={throwOnError:!1},f={mangle:!1,headerIds:!1};marked.use(markedKatex(r),f);let b=marked.parse(n);console.log(b),a.style.display="none",y.innerHTML=b,mt()}function $(){a.style.display="block",y.innerHTML=""}function k(){ot("/blog")}function H(){try{let l=a.value,n=l.split("---")[1],r=jsyaml.load(n),f={Id:_.content==null?null:_.content.Id,Title:r.title,Date:r.date,MarkDown:l,Tags:r.tags,Html:"",Url:""};const b=/^---[\s\S]*?---\s*/m,P=a.value.replace(b,""),T={throwOnError:!1};marked.use(markedKatex(T)),f.Html=marked.parse(P),f.Url=`${r.date.toISOString().split("T")[0]}-${r.title.replaceAll(" ","-")}`;let I=ft();const z=fetch("https://107106.xyz/blog/",{method:_.content==null?"POST":"PUT",body:JSON.stringify(f),headers:{"Content-Type":"application/json",Token:I??""}}).then(()=>{ot("/blog")})}catch(l){window.alert(l.message)}}return jt(()=>{a=document.querySelector("textarea"),y=document.querySelector(".preview"),a.addEventListener("keydown",l=>{if(l.key==="Tab"){const n=a.selectionStart,r=a.selectionEnd;a.value=a.value.substring(0,n)+"	"+a.value.substring(r),a.selectionStart=a.selectionEnd=n+1,l.preventDefault()}}),_.content!=null&&(a.value=_.content.MarkDown)}),h.$$set=l=>{"data"in l&&m(5,_=l.data)},[g,w,$,k,H,_]}class Ct extends vt{constructor(c){super(),_t(this,c,Dt,Ot,ht,{data:5})}}export{Ct as component,Pt as universal};
